<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apply ggplot2 and extend some parts of it â€¢ ggfun</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Apply ggplot2 and extend some parts of it">
<meta property="og:description" content="More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ggfun</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ggfun-vignette.html">ggfun</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<div id="overview" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1></div>
<p>This package <code>ggfun</code> was created as an extension of <code>ggplot2</code> to add some functions for some specific goals, such as replacing points with images, making it more convenient to deal with map in some cases, generating some curves with given parameters, etc. But it is really an excercise for applying ggplot2 extension functionalities and there is large space to improve.</p>
<p>Here are links to our GitHub <a href="https://github.com/yaweige/ggfun">repository</a> where the code for the package is stored and to the package <a href="https://yaweige.github.io/ggfun">website</a> where more information about the package is well shown.</p>
<p>And the shiny app can be found under the<code>inst/shiny-example</code> folder or the system file after you installed the package.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>The package can be downloaded from GitHub. You can use the following code to install.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install the package from github</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"yaweige/ggfun"</span>)</code></pre></div>
<p>You can then load the package in the normal way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the package</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggfun)</code></pre></div>
</div>
<div id="functions" class="section level1">
<h1 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h1>
<div id="geom_image" class="section level3">
<h3 class="hasAnchor">
<a href="#geom_image" class="anchor"></a><code>geom_image</code>
</h3>
<p>This function is used to draw scatter plot as <code>geom_point</code> does, but replaced the points with a predefined image (Elephant and donkey).</p>
<p>The usage is the same as <code>geom_image</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggfun)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

p &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"images.jpg"</span>, <span class="dt">package =</span> <span class="st">"ggfun"</span>)
img &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magick/topics/editing">image_read</a></span>(p)
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="reference/geom_image.html">geom_image</a></span>(<span class="dt">data =</span> mtcars, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg), <span class="dt">img =</span> img, <span class="dt">size =</span><span class="fl">0.05</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="stat_star" class="section level3">
<h3 class="hasAnchor">
<a href="#stat_star" class="anchor"></a><code>stat_star</code>
</h3>
<p>This function applied the algorithm to calculate the distances between the central point (defined by median) and other points, and connect the central point to the farthest point with a line, which can be modified as a regular line object in <code>ggplot2</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">madedata &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),
                       <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>))


<span class="kw">ggplot</span>(madedata, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="reference/stat_star.html">stat_star</a></span>(<span class="dt">color =</span> <span class="st">"red"</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="stat_arrowmap" class="section level3">
<h3 class="hasAnchor">
<a href="#stat_arrowmap" class="anchor"></a><code>stat_arrowmap</code>
</h3>
<p>This function can draw arrow maps for the US. This function requres a specific type of data set, which generated as in the examples, with longutude, latitude and change which usually refers to the changes of party preference in US election for each state.</p>
<p>The required aesthetics are:</p>
<ul>
<li>
<code>x</code>: usually longitude</li>
<li>
<code>y</code>: usually latitude</li>
<li>
<code>change</code>: the changes for each state (can be specified by group aesthetics, as one state by default).</li>
</ul>
<p>Other features can be modified similar to <code>geom_curve</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">usmap &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">"state"</span>)
madedata &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">region =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(usmap<span class="op">$</span>region), 
                                <span class="dt">change =</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">49</span>)<span class="op">-</span><span class="fl">0.5</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
madedata &lt;-<span class="st"> </span>madedata <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(usmap,<span class="dt">by =</span> <span class="st">"region"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">madedata <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="reference/stat_arrowmap.html">stat_arrowmap</a></span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">change =</span> change, <span class="dt">group =</span> region),
                <span class="dt">curvature =</span> <span class="fl">0.3</span>, <span class="dt">angle =</span> <span class="dv">60</span>,
                <span class="dt">size =</span> <span class="dv">1</span>,
                <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">type =</span> <span class="st">"open"</span>,
                              <span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>)))</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="layer_pershomo" class="section level3">
<h3 class="hasAnchor">
<a href="#layer_pershomo" class="anchor"></a><code>layer_PersHomo</code>
</h3>
<p>The function provide a preview of persistant homology for geographic locations. It helps to investigate whether any clustering of the events respect to geographic location. To use the function, a data set with longitude and latitude of multiple geographic locations and a user-defined Geo distance parameter are required.</p>
<p>The required input:</p>
<ul>
<li>
<code>data</code>: The dataframe with longitude and latitude</li>
<li>
<code>x</code>: longitude</li>
<li>
<code>y</code>: latitude</li>
<li>
<code>d</code>: the magnitude of real Geo distance (in km) used as the criterion to link two locations</li>
</ul>
<p>The following example shows the persistant homology of earthquake event around pacific plate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr) 
worldmap &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">"world2"</span>)
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>worldmap, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group =</span> group),<span class="dt">fill=</span><span class="st">"white"</span>, <span class="dt">colour=</span><span class="st">"#7f7f7f"</span>, <span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">legend.position=</span><span class="st">"none"</span>,
        <span class="dt">panel.background=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.border=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
        <span class="dt">plot.background=</span><span class="kw">element_blank</span>())
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(eqRaw)
eq &lt;-<span class="st"> </span>eqRaw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(LONGITUDE <span class="op">&gt;</span><span class="st"> </span><span class="dv">110</span> <span class="op">|</span><span class="st"> </span>LONGITUDE <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="dv">45</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">LONGITUDE =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(LONGITUDE <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, LONGITUDE <span class="op">+</span><span class="st"> </span><span class="dv">360</span>, LONGITUDE)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(YEAR, MONTH,DAY, EQ_MAG_MS, COUNTRY, LOCATION_NAME, LATITUDE, LONGITUDE)
## add layer_PersHomo
fp &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="reference/layer_PersHomo.html">layer_PersHomo</a></span>(<span class="dt">data=</span> eq, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>LONGITUDE, <span class="dt">y=</span>LATITUDE), <span class="dt">d=</span><span class="dv">450000</span>, <span class="dt">colour =</span> <span class="st">"blue"</span>); fp</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="stat_ars" class="section level3">
<h3 class="hasAnchor">
<a href="#stat_ars" class="anchor"></a><code>stat_ars</code>
</h3>
<p>This function applied the algorithm to calculate the Archimedean spiral. Then we apply <code>ggplot2</code> to connect each point to draw a spiral.</p>
<p>The required parameters are:</p>
<ul>
<li>
<code>a</code>: rotating the spiral</li>
<li>
<code>b</code>: distance control between two adjacent curves</li>
<li>
<code>n</code>: the number of turns</li>
</ul>
<p>The following example shows how does this function works based on these three parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">   </span><span class="kw"><a href="reference/stat_ars.html">stat_ars</a></span>(<span class="kw">aes</span>(<span class="dt">a =</span> <span class="dv">8</span>, <span class="dt">b =</span> <span class="dv">20</span>, <span class="dt">n =</span> <span class="dv">2</span>), <span class="dt">col =</span> <span class="st">"coral"</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="stat_rl" class="section level3">
<h3 class="hasAnchor">
<a href="#stat_rl" class="anchor"></a><code>stat_rl</code>
</h3>
<p>This function is used to draw regression line for the each level of the categorical variable.</p>
<p>The required aesthetics are:</p>
<ul>
<li>
<code>x</code>: the numerical explanatory variable</li>
<li>
<code>y</code>: the numerical response variable</li>
<li>
<code>id</code>: the categorical variable with more than one level</li>
</ul>
<p>The following example shows two regression line for the given dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(indexf, <span class="kw">aes</span>(<span class="dt">x =</span> length, <span class="dt">y =</span> width, <span class="dt">id =</span> sex)) <span class="op">+</span>
<span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st"> </span><span class="kw"><a href="reference/stat_rl.html">stat_rl</a></span>(<span class="kw">aes</span>(<span class="dt">x =</span> length, <span class="dt">y =</span>  width, <span class="dt">id =</span> sex, <span class="dt">colour =</span> sex))</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Yawei Ge <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/yaweige/ggfun"><img src="https://travis-ci.org/yaweige/ggfun.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/github/yaweige/ggfun?branch=master"><img src="https://codecov.io/gh/yaweige/ggfun/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Yawei Ge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
